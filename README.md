# Week 04. "All Inclusive" (Slurm Навыкум "Build Containers!")

## Задача

Один из клиентов вполне успешно использует [наше приложение](../../03_week/0301_springboot/), но вот незадача: клиент хочет демонстрационный образ, в котором приложение будет сразу с СУБД PostgreSQL, чтобы (цитата): "запустил контейнер и сразу и приложение запустилось, и PostgreSQL" (несмотря на то, что мы убеждали клиента в том, что, по-хорошему, один контейнер &ndash; один процесс*)

Примечание*: но вы, конечно, уже знаете, что при необходимости мы вполне можем запускать множество процессов тогда, когда это действительно требуется

### Что нужно сделать

Соберите требуемый образ, взяв за основу либо [`postgres:14`](https://hub.docker.com/_/postgres), либо [`eclipse-temurin:17`](https://hub.docker.com/_/eclipse-temurin/) (что сами сочтёте более удобным)

Сборку Java-приложения производите отдельным Stage в [`maven:3-eclipse-temurin-17`](https://hub.docker.com/_/maven)

**Важно**: при решении этой задачи можно и нужно писать `ENTRYPOINT` (в виде shell-скрипта), который всё и запустит

Ключевое требование: при завершении процесса Java работа контейнера должна завершаться

В собранном образе должны `EXPOSE`'иться как порты приложения, так и порты PostgreSQL

При этом, конечно же, должна сохраниться возможность использовать `docker-entrypoint-initdb.d`, т.е.:
1. Сначала запускается PostgreSQL, инициализируется из переданных переменных (например, имя пользователя, БД и пароль) и `docker-entrypoint-initdb.d` &ndash; как в оригинальном образе
2. Затем уже запускается Java-приложение

### Требования

1. Всё должно быть оформлено в виде публичного репозитория на GitHub
2. Вся сборка образов должна проходить через GitHub Actions
3. Образ должен выкладываться в GitHub Container Registry (GHCR)
